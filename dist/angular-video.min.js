/*! angular-video, built 2016-02-20T11:33:16 */
!function(){"use strict";function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints}var module=angular.module("jrl-video",["ngAnimate"]),scripts=document.getElementsByTagName("script"),src=scripts[scripts.length-1].src.split(/[\\/]/);src.pop(),module.constant("JRL_VIDEO_ROOT",src.join("/")+"/"),module.directive("jrlVideoPlayer",["$timeout","jrlKeyboardControls","jrlTouchControls","JRL_VIDEO_ROOT",function($timeout,jrlKeyboardControls,jrlTouchControls,JRL_VIDEO_ROOT){function link(scope,element,attrs){function setControlVisibility(shouldShow){scope.shouldShowControls=shouldShow,$timeout(function(){scope.$apply()})}scope.shouldShowControls=scope.controls;var $video=element.find("video");scope.playerControls=isTouchDevice()?jrlTouchControls:jrlKeyboardControls,scope.player.init(element,$video),scope.autoplay&&$video.attr("autoplay",!0),scope.loop&&$video.attr("loop",!0),scope.muted&&scope.player.toggleMute(),"undefined"!==scope.controls&&scope.controls&&scope.playerControls.init(element,setControlVisibility),$video.on("click",function(){scope.player.togglePlayback()})}return{link:link,restrict:"E",templateUrl:JRL_VIDEO_ROOT+"html.html",scope:{video:"=",player:"=",controls:"=",autoplay:"=",loop:"=",controlsTimeout:"=",muted:"="},replace:!0}}]).directive("jrlVideoControls",["$rootScope","JRL_VIDEO_ROOT",function($rootScope,JRL_VIDEO_ROOT){function link(scope,element,attrs){function durationChange(){scope.player.durationChange(),scope.$apply()}function timeUpdate(){scope.progressStyle={width:parseInt(this.currentTime/scope.player.duration*100)+"%"},scope.player.timeUpdate(this.currentTime),scope.$apply()}function togglePlayback(){scope.player.togglePlayback()}function toggleFullscreen(){scope.player.toggleFullscreen(),scope.controls.hide(),element.parent().mousemove(function(){scope.controls.show()})}function seek(e){scope.player.seek((e.pageX-$progressContainer.offset().left)/$progressContainer.width()*scope.player.duration)}function skip(direction){scope.player.seek(scope.player.video[0].currentTime+direction)}function playbackComplete(){scope.player.playbackComplete(),element.show(),scope.$apply()}function formatTime(seconds){seconds=parseInt(seconds);var rawMinutes=Math.floor(seconds/60),minutes=rawMinutes%60,hours=Math.floor(rawMinutes/60),seconds=seconds%60;return(hours>0?hours+":":"")+(10>minutes?"0":"")+minutes+":"+(10>seconds?"0":"")+seconds}scope.togglePlayback=togglePlayback,scope.toggleFullscreen=toggleFullscreen,scope.seek=seek,scope.formatTime=formatTime,scope.skip=skip,scope.progressStyle={width:"0"},scope.player.video[0].addEventListener("durationchange",durationChange),scope.player.video[0].addEventListener("timeupdate",timeUpdate),scope.player.video[0].addEventListener("ended",playbackComplete);var $progressContainer=element.find(".video-track")}return{link:link,restrict:"E",templateUrl:JRL_VIDEO_ROOT+"controls.html",scope:{video:"=",player:"=",controls:"="},replace:!0}}]).directive("jrlVideoPlayButton",["JRL_VIDEO_ROOT",function(JRL_VIDEO_ROOT){function link(scope,element,attrs){function play($e){return scope.player.togglePlayback(),$e.preventDefault(),!1}scope.play=play,scope.$watch(function(){return scope.player.isPaused},function(newVal){newVal?element.hide():element.show()})}return{link:link,restrict:"E",templateUrl:JRL_VIDEO_ROOT+"play.html",scope:{player:"="},replace:!0}}]).directive("jrlVideoButtonVolume",["$timeout","JRL_VIDEO_ROOT",function($timeout,JRL_VIDEO_ROOT){function link(scope,element,attrs){function setBarVisibility(shouldShow){scope.showVolumeCtrl=shouldShow,scope.$apply()}function setVolume(e){var containerHeight=$volumeBar.height(),relY=e.pageY-$volumeBar.offset().top;scope.player.changeVolume((containerHeight-relY)/containerHeight),e.stopPropagation()}function toggleMute(){scope.player.toggleMute(),$timeout(function(){scope.$apply()})}scope.showVolumeCtrl=!1,scope.setVolume=setVolume,scope.toggleMute=toggleMute;var $volumeBar=(element.find(".volume-container"),element.find(".volume-bar")),$volumeSetting=element.find(".volume-bar-setting");scope.controls.registerVolumeBtn(element,$volumeBar,setBarVisibility,setVolume),scope.$watch(function(){return scope.player.volume},function(newVal){$volumeSetting.css({height:$volumeBar.height()*newVal})})}return{restrict:"E",replace:!0,templateUrl:JRL_VIDEO_ROOT+"volume.html",link:link,scope:{player:"=",controls:"="}}}]).service("HtmlPlayer",["$rootScope",function($rootScope){function init(element,video){document.addEventListener("fullscreenchange",onFullScreenChange),document.addEventListener("webkitfullscreenchange",onFullScreenChange),document.addEventListener("mozfullscreenchange",onFullScreenChange),document.addEventListener("MSFullscreenChange",onFullScreenChange),svc.element=element,svc.video=video,svc.changeVolume(.5)}function playbackComplete(){svc.isPaused=!0}function durationChange(){svc.duration=svc.video[0].duration}function timeUpdate(time){svc.currentTime=time}function onFullScreenChange(){svc.isFullscreen=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}function toggleMute(){svc.video[0].volume=svc.video[0].volume?0:oldVolume,svc.volume=svc.video[0].volume}function changeVolume(volume){svc.volume=oldVolume=volume,svc.video[0].volume=volume}function togglePlayback(){return svc.video[0].paused?svc.video[0].play():svc.video[0].pause(),setTimeout(function(){$rootScope.$apply()}),!(svc.isPaused=!svc.isPaused)}function supportsFullscreen(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}function toggleFullscreen(){function enterFullscreen(element){element.requestFullscreen?(element.requestFullscreen(),svc.isFullscreen=!0):element.webkitRequestFullscreen?(element.webkitRequestFullscreen(),svc.isFullscreen=!0):element.mozRequestFullScreen?(element.mozRequestFullScreen(),svc.isFullscreen=!0):element.msRequestFullscreen&&(element.msRequestFullscreen(),svc.isFullscreen=!0)}function exitFullscreen(){document.exitFullscreen?(document.exitFullscreen(),svc.isFullscreen=!1):document.webkitExitFullscreen?(document.webkitExitFullscreen(),svc.isFullscreen=!1):document.mozCancelFullScreen?(document.mozCancelFullScreen(),svc.isFullscreen=!1):document.msExitFullscreen&&(document.msExitFullscreen(),svc.isFullscreen=!1)}document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?exitFullscreen():enterFullscreen(svc.element[0])}function seek(time){svc.video[0].currentTime=time}var svc={currentTime:0,volume:0,duration:0,element:null,isFullscreen:!1,isPaused:!0,video:null,changeVolume:changeVolume,durationChange:durationChange,init:init,playbackComplete:playbackComplete,seek:seek,supportsFullscreen:supportsFullscreen,timeUpdate:timeUpdate,toggleFullscreen:toggleFullscreen,toggleMute:toggleMute,togglePlayback:togglePlayback},oldVolume=0;return svc}]).service("jrlTouchControls",[function(){function hide(){showCtrl(!1)}function show(){showCtrl(!0)}function init(element,$video,toggleCtrl){showCtrl=toggleCtrl;var showing=!1;element.on("click",function(){showing=!showing,toggleCtrl(showing)})}function registerVolumeBtn(element,$volumeBar,toggleVolumeBar,setVolume){element.click(function(){console.log("volume button click")}),$volumeBar.click(function(e){setVolume(e)})}var showCtrl,svc={hide:hide,show:show,init:init,registerVolumeBtn:registerVolumeBtn};return svc}]).service("jrlKeyboardControls",["$timeout",function($timeout){function hide(){showCtrl(!1)}function show(){showCtrl(!0)}function init(element,toggleCtrl){var timeoutPromise;showCtrl=toggleCtrl,element.hover(function(){timeoutPromise&&$timeout.cancel(timeoutPromise),show()},function(e){timeoutPromise=$timeout(function(){hide()},750)})}function registerVolumeBtn(element,$volumeBar,toggleVolumeBar,setVolume){var mouseClicking=!1;element.hover(function(){toggleVolumeBar(!0)},function(){toggleVolumeBar(!1)}),$volumeBar.mousemove(function(e){mouseClicking&&setVolume(e)}),$volumeBar.mousedown(function(){mouseClicking=!0}),$volumeBar.mouseup(function(){mouseClicking=!1})}var showCtrl,svc={hide:hide,show:show,init:init,registerVolumeBtn:registerVolumeBtn};return svc}])}();